name: mnist_ablation
experiment:
  dataset: &dataset
    __object__: src.explib.datasets.MnistSplit
    digit: 3
  
  model_cfg: 
    type:
      __class__: &model src.veriflow.flows.NiceFlow
    params:
      soft_training: true #TODO: I think at test phase we don't need this soft training flag to true
      training_noise_prior:
        __object__: pyro.distributions.Uniform
        low: 
          __eval__: 1e-20
        high: 0.01
      prior_scale: 1.0
      coupling_layers: 10
      coupling_nn_layers: [300, 300, 300] 
      nonlinearity: &nonlinearity 
        __eval__: torch.nn.ReLU()  
      split_dim: 392
      base_distribution: 
        __object__: pyro.distributions.Laplace
        loc: 
          __eval__: torch.zeros(784).to("cpu")
        scale: 
          __eval__: torch.ones(784).to("cpu")          
      use_lu: true 