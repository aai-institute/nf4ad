name: mnist_ablation_3
experiment:
  dataset: &dataset
    __object__: src.explib.datasets.MnistSplit
    digit: 3
  model_cfg: 
    type:
      __class__: &model src.veriflow.flows.NiceFlow
    params:
      soft_training: true
      training_noise_prior:
        __object__: pyro.distributions.Uniform
        low: 
          __eval__: 1e-20
        high: 0.01
      prior_scale: 1.0
      coupling_layers: 10
      coupling_nn_layers: [300, 300, 300] 
      nonlinearity: &nonlinearity 
        __eval__: torch.nn.ReLU()
      split_dim: 392
      base_distribution: 
        __object__: src.veriflow.distributions.RadialDistribution       
        device: cpu
        p: 1.0
        loc: 
          __eval__: torch.zeros(784).to("cpu")
        norm_distribution:
          __object__: pyro.distributions.LogNormal
          loc: 
            __eval__: torch.zeros(1).to("cpu")
          scale: 
            __eval__: (.5 * torch.ones(1)).to("cpu")
      use_lu: true